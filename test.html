<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<title>ã€‚ï½¥ï¾Ÿï½¥äº’å‹•è¦–é »ã€‚ï½¥ï¾Ÿï½¥ ã€Šæœªæ¥ä¾†é›»ã€‹</title>
<link rel="icon" type="image/png" href="Screenshot_2025_1209_164830.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
   .music-hit {
    position: absolute;

    /* â—è«‹ä¾ä½ çš„åº•åœ–å¾®èª¿ */
    left: 90%;
    top: 68%;

    width: 70px;
    height: 70px;
    border-radius: 50%;

    background: rgba(255, 0, 0, 50); /* å®Œå…¨é€æ˜ */
    border: none;
    cursor: pointer;
    z-index: 15;
}

/* =================================================
   é–‹å§‹ç•«é¢èˆ‡è´è¶ç™¼å…‰æ¨£å¼
================================================= */
#start-screen {
    position: fixed;
    inset: 0;
    background: black;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 300;
}

/* é€™æ˜¯é—œéµï¼šå¼·åˆ¶è®“èƒŒæ™¯åœ–å®¹å™¨ä¿æŒ 16:9 æ¯”ä¾‹ */
.start-content-wrapper {
    position: relative;
    aspect-ratio: 16 / 9;
    height: 100%;
    max-width: 100%;
    background: url("é–‹å§‹ä»‹é¢.png") center center / contain no-repeat;
}

/* è´è¶åœ–å±¤ï¼šç–Šåœ¨èƒŒæ™¯åœ–æ­£ä¸Šæ–¹ */
#butterfly-layer {
    position: absolute;
    inset: 0;
    background: url("è´è¶é€æ˜å±¤.png") center center / contain no-repeat;
    pointer-events: none;
    z-index: 1;
}

   #butterfly-layer::before {
    content: "";
    position: absolute;
    inset: 0;
    background: inherit;
    filter: blur(28px);
    opacity: 0;
    transform: scale(1.05);
   }
   @keyframes butterflyGlow {
    0% {
        opacity: 0;
    }
    40% {
        opacity: 1;
    }
    70% {
        opacity: 1;
    }
    100% {
        opacity: 0;
    }
   }
/* è´è¶æ·¡å…¥æ·¡å‡ºçš„ç™¼å…‰å‹•ç•« */
/*@keyframes butterflyGlowEffect {
    0% { opacity: 0; filter: drop-shadow(0 0 0px #ffb6c1); }
    40% { opacity: 1; filter: drop-shadow(0 0 25px #ff69b4) brightness(1.5); }
    70% { opacity: 1; filter: drop-shadow(0 0 30px #ffb6c1) brightness(1.6); }
    100% { opacity: 0; filter: drop-shadow(0 0 0px #ffb6c1); }
}*/

/* å•Ÿå‹•å‹•ç•«çš„ Class */
.butterfly-glow-active::before {
    animation: butterflyGlow 2s ease-in-out forwards;
}

.start-hit {
    position: absolute;
    /* æ”¹ç”¨ç™¾åˆ†æ¯”ï¼Œé€™æ¨£åœ–ç‰‡ç¸®å°æ™‚æŒ‰éˆ•æ‰æœƒè·Ÿè‘—å‹• */
    left: 55%;      
    width: 28%;     
    height: 12%;    
    background: rgba(255, 0, 0, 0); /* æœ€å¾Œä¸€å€‹æ•¸å­— 0 ä»£è¡¨é€æ˜ï¼Œæ¸¬è©¦æ™‚å¯æ”¹ 0.3 */
    border: none;
    cursor: pointer;
    z-index: 10;
}

/* å¾®èª¿ä¸‰å€‹æŒ‰éˆ•çš„ä½ç½®èˆ‡å¤§å° */
.start-extra { 
    top: 35%; 
}

/* é€™è£¡æ˜¯ä¸­é–“é‚£å€‹ã€Œé–‹å§‹éŠæˆ²ã€ï¼Œæˆ‘å€‘å–®ç¨çµ¦å®ƒæ›´å¤§çš„å¯¬é«˜ */
.start-begin { 
    top: 55%;  
    left: 54.5%; 
    width: 24%; 
    height: 20%; 
}

.start-ending { 
    top: 80%; 
}

/* =================================================
   åŸºæœ¬ç•«é¢è¨­å®š
================================================= */
html, body {
    margin: 0;
    width: 100%;
    height: 100%;
    background: black;
    overflow: hidden;
    font-family: Arial, sans-serif;
}

/* =================================================
   å½±ç‰‡å®¹å™¨
================================================= */
#video-container {
    position: fixed;
    inset: 0;
}

/* =================================================
   ä¸»å½±ç‰‡
   â˜… ä½¿ç”¨ containï¼Œç¢ºä¿ 4:3 å½±ç‰‡å®Œæ•´é¡¯ç¤º
   â˜… é»‘é‚Šç”±èƒŒæ™¯è£œä¸Š
================================================= */
#main-video {
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: black;
}

/* =================================================
   é¸é …æŒ‰éˆ•å€
================================================= */
#options {
    position: absolute;
    bottom: 12%;
    left: 50%;
    transform: translateX(-50%);
    display: none;
    gap: 20px;
    align-items: center;
    z-index: 10;
}

/* ===============================
   é›™å±¤äº¤éŒ¯é¸é …æŒ‰éˆ•
=============================== */
.choice-btn {
    position: relative;
    width: 220px;
    height: 56px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
}

/* ä¸‹å±¤ */
.choice-btn .btn-back {
    position: absolute;
    inset: 0;
    background: white;              /* â† ä¸€é–‹å§‹ç™½è‰² */
    border-radius: 30px;
    transform: translate(6px, 6px); /* â† å›ºå®šåœ¨å³ä¸‹ */
    transition: transform 0.15s cubic-bezier(.2,.8,.2,1);
}
   .choice-btn:hover .btn-back {
    background: #e60012; /* é®®ç´…è‰² */
   }
/* ä¸Šå±¤ */
.choice-btn .btn-front {
    position: absolute;
    inset: 0;
    background: #111;
    border: 1px solid white;
    color: white;
    border-radius: 30px;

    display: flex;
    align-items: center;
    justify-content: center;
    transform: translate(-4px, -4px); /* â† åŸæœ¬å°±åœ¨å·¦ä¸Š */

    transition: transform 0.15s cubic-bezier(.2,.8,.2,1);
}

/* hoverï¼šä¸Šå±¤æµ®èµ· */
.choice-btn:hover .btn-front {
    transform: translate(-8px, -8px); /* â† å†å¾€å·¦ä¸Šæ»‘ */
}
/* æ‰‹æ©Ÿ / å¹³æ¿æŒ‰å£“æ„Ÿ */
.choice-btn:active .btn-front {
    transform: translate(-2px, -2px);
}

/* =================================================
   å³å´åŠŸèƒ½éµï¼ˆå­˜æª” / è®€æª”ï¼‰
================================================= */
#menu-btns {
    position: fixed;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    z-index: 50;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

#menu-btns button {
    padding: 10px 18px;
    background: rgba(0,0,0,0.6);
    color: white;
    border: 1px solid white;
    border-radius: 20px;
    cursor: pointer;
}

/* =================================================
   çµå±€ç”¨ã€Œå›åˆ°é–‹ç«¯ã€
================================================= */
#restart {
    position: absolute;
    bottom: 12%;
    left: 50%;
    transform: translateX(-50%);
    display: none;
    z-index: 20;
}

/* =================================================
   å­˜æª” / è®€æª”é®ç½©
================================================= */
.menu {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.75);
    display: none;
    z-index: 100;
}

.menu-box {
    width: 80%;
    max-width: 620px;
    margin: 8% auto;
    background: #111;
    color: white;
    padding: 20px;
    border-radius: 12px;
    position: relative;
}

.close {
    position: absolute;
    top: 10px;
    right: 15px;
    cursor: pointer;
}

/* =================================================
   å­˜æª”æ ¼
================================================= */
.slots {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
}

.slot {
    background: #000;
    border: 1px solid #444;
    cursor: pointer;
}

.slot img {
    width: 100%;
    height: 80px;
    object-fit: cover;
    background: #222;
}

.slot p {
    font-size: 12px;
    text-align: center;
    margin: 5px 0;
}
   
</style>
</head>

<body>
   <video id="bgm-video" preload="auto" style="display:none">
    <source src="é–‹å§‹ç•«é¢éŸ³æ¨‚.mp4" type="video/mp4">
</video>

   <div id="start-screen">
      <div class="start-content-wrapper">
         <div id="butterfly-layer"></div>

         <button class="start-hit start-extra"></button>
         <button class="start-hit start-begin" onclick="startGame()"></button>
         <button class="start-hit start-ending"></button>
         <button class="music-hit" onclick="toggleMusic()"></button>

      </div>
   </div>

   <div id="video-container">
      <video id="main-video" playsinline></video>
      <div id="options"></div>
      <div id="menu-btns">
         <button onclick="openSaveMenu()">å­˜æª”</button>
         <button onclick="openLoadMenu()">è®€æª”</button>
      </div>
      <div id="restart">
         <button onclick="restartGame()">å›åˆ°é–‹ç«¯</button>
      </div>
   </div>

   <div id="save-menu" class="menu">
      <div class="menu-box">
         <span class="close" onclick="closeMenus()">âœ•</span>
         <h2>å­˜æª”</h2>
         <div id="save-slots" class="slots"></div>
      </div>
   </div>

   <div id="load-menu" class="menu">
      <div class="menu-box">
         <span class="close" onclick="closeMenus()">âœ•</span>
         <h2>è®€æª”</h2>
         <div id="load-slots" class="slots"></div>
      </div>
   </div>

<script>
   const bgmVideo = document.getElementById("bgm-video");
let musicStarted = false;

function toggleMusic() {
    bgmVideo.loop = true;

    if (bgmVideo.paused) {
        bgmVideo.volume = 0.6;
        bgmVideo.play().catch(() => {});
    } else {
        bgmVideo.pause();
    }
}


   function fadeOutBGM(duration = 1000) {
    const step = 50;
    const volumeStep = bgmVideo.volume / (duration / step);

    const fade = setInterval(() => {
        if (bgmVideo.volume > volumeStep) {
            bgmVideo.volume -= volumeStep;
        } else {
            bgmVideo.volume = 0;
            bgmVideo.pause();
            bgmVideo.volume = 0.6; // é‡ç½®çµ¦ä¸‹æ¬¡
            clearInterval(fade);
        }
    }, step);
}


function startGame() {
    const butterfly = document.getElementById("butterfly-layer");
    const screen = document.getElementById("start-screen");

    butterfly.classList.add("butterfly-glow-active");

    // â­ å¦‚æœéŸ³æ¨‚æœ‰æ’­ï¼Œæ‰æ·¡å‡º
    if (!bgmVideo.paused) {
        fadeOutBGM(1200);
    }

    setTimeout(() => {
        screen.style.transition = "opacity 0.8s";
        screen.style.opacity = "0";

        setTimeout(() => {
            screen.style.display = "none";
            loadScene("start");

            butterfly.classList.remove("butterfly-glow-active");
            screen.style.opacity = "1";
        }, 800);
    }, 2000);
}


/* =================================================
   åŠ‡æƒ…è³‡æ–™ï¼ˆä½ ä¹‹å¾Œåªéœ€è¦æ”¹é€™ä¸€å€ï¼‰
================================================= */
const story = {

    ignore: {
        title: "ç„¡æ³•åœç•™çš„äººé–“",
        video: "endå–§å›‚.mp4",
        choices: [],
        isEnd: true
    },

    only_you: {
        title: "è½å–®",
        video: "endè½å–®.mp4",
        choices: [],
        isEnd: true
    },

   the_blood: {
        title: "å†ä¹Ÿé€ƒé›¢ä¸äº†çš„æƒ¡å¤¢",
        video: "endè¡€è‰²çš„å‘»åŸ.mp4",
        choices: [],
        isEnd: true
    },

    start: {
        title: "é–‹ç«¯",
        video: "é–‹ç«¯.mp4",
        choices: [
            { text: "ä¸Šå‰è©¢å•", next: "reply" },
            { text: "ä¸ç®¡äº†ï¼Œé‚„æ˜¯å›å®¶å§â€¦â€¦", next: "ignore" }
        ]
    },

    reply: {
        title: "åˆæ¬¡è¦‹é¢",
        video: "æ­è©±.mp4",
        choices: [
            { text: "å¥½çš„", next: "yes" },
            { text: "ä¸å»", next: "no" }
        ]
    },

   yes: {
        title: "æ´›å…‹æ–¯çš„å’–å•¡å»³",
        video: "å’–å•¡å»³.mp4",
        choices: [
            { text: "ç­‰å¾…ä»–å›ä¾†", next: "wait" },
            { text: "æ­£åœ¨æ–½å·¥,å‹¿é»!", next: "sorry" }
        ]
    },

   wait: {
        title: "å†æ¬¡ç›¸é‡",
        video: "ç­‰ä»–å›æ¥.mp4",
        choices:[],
        nextScene: "her_hair"
    },
   
    no: {
        title: "è‰¾çˆ¾çš„é‚€ç´„",
        video: "è›‹ç³•åº—.mp4",
        choices: [
            { text: "ç­”æ‡‰ä»–", next: "go" },
            { text: "æ‹’çµ•ä»–", next: "dont_go" }
        ]
    },

    dont_go: {
        title: "æ‹’çµ•",
        video: "æ‹’çµ•.mp4",
        choices: [],
        nextScene: "only_you"
    },

    go: {
        title: "æœŸå¾…çš„æ˜æ—¥",
        video: "ä¸€èµ·å».mp4",
        choices: [],
        nextScene: "make_cake"
    },

    make_cake: {
        title: "ç”œé»æ™‚å…‰",
        video: "åšè›‹ç³•.mp4",
        choices: [],
        nextScene: "eat_cake"
    },
   
   eat_cake: {
        title: "å¥¶æ²¹èˆ‡å¿ƒè·³",
        video: "åƒè›‹ç³•.mp4",
        choices: [
           { text: "è‡ªå·±æ­åœ°éµ", next: "the_blood" },
           { text: "è®“è‰¾çˆ¾é€ä½ ", next: "talking" }
        ],
    },
   
   talking: {
        title: "ä½ çš„ä¸»å‹•",
        video: "ä¸€èµ·å›å®¶.mp4",
        choices: [
           { text: "æåŠç«¥å¹´", next: "mother" },
           { text: "æåŠå°è²“<æ–½å·¥ä¸­>", next: "cat" },
           { text: "æ²‰é»˜<æ–½å·¥ä¸­>", next: "quite" }
        ],
    },

   mother: {
        title: "å°ç«¥å¹´çš„è†è½",
        video: "ç«¥å¹´çš„è©•åƒ¹.mp4",
        choices: [
           { text: "æ¯è¦ªéƒ½æ˜¯ç‚ºäº†ä½ å¥½<æ–½å·¥ä¸­>", next: "the_best_choice" },
           { text: "ä»¥å¾Œéƒ½æœ‰æˆ‘åœ¨<æ–½å·¥ä¸­>", next: "i_will_by_your_side" },
        ],
    },
};

/* =================================================
   ç³»çµ±ç‹€æ…‹
================================================= */
const video = document.getElementById("main-video");
const options = document.getElementById("options");
let currentScene = "start";
let wasPlaying = false;

/* =================================================
   è¼‰å…¥ä¸¦æ’­æ”¾å ´æ™¯
================================================= */
function loadScene(key) {
    currentScene = key;
    const scene = story[key];

    // å…ˆåœæ­¢èˆŠå½±ç‰‡
    video.pause();
    video.removeAttribute("src"); // ğŸ”´ å¾ˆé‡è¦ï¼Œæ¸…ä¹¾æ·¨
    video.load();

    // æŒ‡å®šæ–°å½±ç‰‡
    video.src = scene.video;
    video.load();

    // UI é‡ç½®
    options.innerHTML = "";
    options.style.display = "none";
    document.getElementById("restart").style.display = "none";

    // âœ… ç­‰ metadata è¼‰å¥½å†æ’­
    video.onloadedmetadata = () => {
        video.currentTime = 0;
        video.play().catch(err => console.warn("æ’­æ”¾è¢«é˜»æ“‹", err));
    };

    // æ’­æ”¾çµæŸ
    video.onended = () => {
        if (scene.isEnd) {
            document.getElementById("restart").style.display = "block";
            return;
        }

        if (scene.choices.length === 0 && scene.nextScene) {
            loadScene(scene.nextScene);
            return;
        }

        scene.choices.forEach(c => {
            const btn = document.createElement("button");
            btn.className = "choice-btn";

            btn.innerHTML = `
                <span class="btn-back"></span>
                <span class="btn-front">${c.text}</span>
            `;

            btn.onclick = () => loadScene(c.next);
            options.appendChild(btn);
        });

        options.style.display = "flex";
    };
}

/* =================================================
   å­˜æª” / è®€æª” UI
================================================= */
function openSaveMenu() {
    wasPlaying = !video.paused;
    video.pause();
    generateSlots("save");
    document.getElementById("save-menu").style.display = "block";
}

function openLoadMenu() {
    wasPlaying = !video.paused;
    video.pause();
    generateSlots("load");
    document.getElementById("load-menu").style.display = "block";
}

function closeMenus() {
    document.getElementById("save-menu").style.display = "none";
    document.getElementById("load-menu").style.display = "none";
    if (wasPlaying) video.play();
}

/* =================================================
   å­˜æª”æ ¼ç”Ÿæˆ
================================================= */
function generateSlots(type) {
    const container = document.getElementById(type + "-slots");
    container.innerHTML = "";

    for (let i = 1; i <= 9; i++) {
        const data = localStorage.getItem("save_" + i);
        const slot = document.createElement("div");
        slot.className = "slot";

        const img = document.createElement("img");
        const p = document.createElement("p");

       if (data) {
    const save = JSON.parse(data);
    img.style.display = "none"; // æˆ–çµ¦å›ºå®šåœ–
    p.innerText = save.title;
} else {
    img.style.display = "none";
    p.innerText = "ç©ºç™½å­˜æª”";
}


        slot.appendChild(img);
        slot.appendChild(p);
        slot.onclick = () => type === "save" ? saveToSlot(i) : loadFromSlot(i);

        container.appendChild(slot);
    }
}

/* =================================================
   å­˜æª”å¯¦ä½œ
================================================= */
function saveToSlot(i) {
    try {
        const saveData = {
            scene: currentScene,
            title: story[currentScene].title,
            time: video.currentTime || 0
        };

        localStorage.setItem("save_" + i, JSON.stringify(saveData));
        closeMenus();
    } catch (e) {
        alert("å­˜æª”ç©ºé–“å·²æ»¿ï¼Œè«‹æ¸…é™¤èˆŠå­˜æª”");
        console.error(e);
    }
}


/* =================================================
   è®€æª”å¯¦ä½œ
================================================= */
function loadFromSlot(i) {
    const data = localStorage.getItem("save_" + i);
    if (!data) return;

    const save = JSON.parse(data);
    closeMenus();
    loadScene(save.scene);

    video.onloadedmetadata = () => {
        video.currentTime = save.time;
        video.play().catch(() => {});
    };
}

/* =================================================
   å›åˆ°é–‹ç«¯
================================================= */
function restartGame() {
    video.pause();
    document.getElementById("start-screen").style.display = "flex";
    loadScene("start");
}

</script>

</body>
</html>
