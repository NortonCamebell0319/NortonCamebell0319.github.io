<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<title>ã€‚ï½¥ï¾Ÿï½¥äº’å‹•è¦–é »ã€‚ï½¥ï¾Ÿï½¥ ã€Šæœªæ¥ä¾†é›»ã€‹</title>
    <link rel="icon" type="image/png" href="Screenshot_2025_1209_164830.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
    margin: 0;
    width: 100%;
    height: 100%;
    background: black;
    overflow: hidden;
    font-family: Arial, sans-serif;
}

/* ===== å½±ç‰‡ ===== */
#video-container {
    position: fixed;
    inset: 0;
}

#main-video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    background: black;
}

/* ===== é¸é … ===== */
#options {
    position: absolute;
    bottom: 12%;
    left: 50%;
    transform: translateX(-50%);
    display: none;
    gap: 20px;
    z-index: 10;
}

#options button {
    padding: 14px 32px;
    border-radius: 30px;
    background: rgba(0,0,0,0.65);
    color: white;
    border: 1px solid white;
    cursor: pointer;
}

/* ===== å³å´å›ºå®šæŒ‰éˆ• ===== */
#menu-btns {
    position: fixed;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    z-index: 50;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

#menu-btns button {
    padding: 10px 18px;
    background: rgba(0,0,0,0.6);
    color: white;
    border: 1px solid white;
    border-radius: 20px;
    cursor: pointer;
}

/* ===== Overlay ===== */
.menu {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.75);
    display: none;
    z-index: 100;
}

.menu-box {
    width: 80%;
    max-width: 620px;
    margin: 8% auto;
    background: #111;
    color: white;
    padding: 20px;
    border-radius: 12px;
    position: relative;
}

.close {
    position: absolute;
    top: 10px;
    right: 15px;
    cursor: pointer;
}

/* ===== å­˜æª”æ ¼ ===== */
.slots {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
}

.slot {
    background: #000;
    border: 1px solid #444;
    cursor: pointer;
}

.slot img {
    width: 100%;
    height: 80px;
    object-fit: cover;
    background: #222;
}

.slot p {
    font-size: 12px;
    text-align: center;
    margin: 5px 0;
}
</style>
</head>

<body>

<div id="video-container">
    <video id="main-video" autoplay></video>
    <div id="options"></div>

    <div id="menu-btns">
        <button onclick="openSaveMenu()">å­˜æª”</button>
        <button onclick="openLoadMenu()">è®€æª”</button>
    </div>
</div>
    <div id="restart" style="
    position:absolute;
    bottom:12%;
    left:50%;
    transform:translateX(-50%);
    display:none;
    z-index:20;
">
    <button onclick="restartGame()">å›åˆ°é–‹ç«¯>ã„ã„¨ã„Ÿâ€„ã„‰ã„ >ã„
</div>


<!-- å­˜æª”ç•«é¢ -->
<div id="save-menu" class="menu">
    <div class="menu-box">
        <span class="close" onclick="closeMenus()">âœ•</span>
        <h2>å­˜æª”</h2>
        <div id="save-slots" class="slots"></div>
    </div>
</div>

<!-- è®€æª”ç•«é¢ -->
<div id="load-menu" class="menu">
    <div class="menu-box">
        <span class="close" onclick="closeMenus()">âœ•</span>
        <h2>è®€æª”</h2>
        <div id="load-slots" class="slots"></div>
    </div>
</div>

<script>
/* ===== åŠ‡æƒ…è³‡æ–™ ===== */
const story = {
    start: {
        title: "é–‹ç«¯",
        video: "é–‹ç«¯.mp4",
        choices: [
            { text: "ä¸Šå‰è©¢å•", next: "reply" },
            { text: "ä¸ç®¡äº†ï¼Œé‚„æ˜¯å›å®¶å§â€¦â€¦", next: "ignore" }
        ]
    },

    reply: {
        title: "åˆæ¬¡è¦‹é¢",
        video: "videos/scene2.mp4",
        choices: []
    },

    ignore: {
        title: "ç„¡æ³•åœç•™çš„äººé–“",
        video: "endå–§å›‚.mp4",
        choices: [],
        isEnd: true
    }
};


const video = document.getElementById("main-video");
const options = document.getElementById("options");
let currentScene = "start";

/* ===== æ’­æ”¾å ´æ™¯ ===== */
function loadScene(key) {
    currentScene = key;
    const scene = story[key];
    video.src = scene.video;
    options.style.display = "none";

    video.onended = () => {
        options.innerHTML = "";
        scene.choices.forEach(c => {
            const btn = document.createElement("button");
            btn.textContent = c.text;
            btn.onclick = () => loadScene(c.next);
            options.appendChild(btn);
        });
        if (scene.choices.length) options.style.display = "flex";
    };
}

/* ===== å­˜è®€ä»‹é¢ ===== */
function openSaveMenu() {
    wasPlaying = !video.paused; // è¨˜ä½åŸæœ¬æœ‰æ²’æœ‰åœ¨æ’­
    video.pause();              // â­ å­˜æª”æ™‚æš«åœå½±ç‰‡
    generateSlots("save");
    document.getElementById("save-menu").style.display = "block";
}


function openLoadMenu() {
    wasPlaying = !video.paused; // è¨˜ä½åŸæœ¬æœ‰æ²’æœ‰åœ¨æ’­
    video.pause();              // â­ è®€æª”æ™‚ä¹Ÿæš«åœå½±ç‰‡
    generateSlots("load");
    document.getElementById("load-menu").style.display = "block";
}


function closeMenus() {
    document.getElementById("save-menu").style.display = "none";
    document.getElementById("load-menu").style.display = "none";

    if (wasPlaying) {
        video.play(); // â­ å¦‚æœåŸæœ¬åœ¨æ’­ï¼Œé—œé–‰å¾Œç¹¼çºŒ
    }
}


/* ===== è‡ªå‹•ç”Ÿæˆ 9 æ ¼ ===== */
function generateSlots(type) {
    const container = document.getElementById(type + "-slots");
    container.innerHTML = "";

    for (let i = 1; i <= 9; i++) {
        const data = localStorage.getItem("save_" + i);
        const slot = document.createElement("div");
        slot.className = "slot";

        const img = document.createElement("img");
        const p = document.createElement("p");

        if (data) {
            const save = JSON.parse(data);
            img.src = save.thumbnail;
            p.innerText = save.title;
        } else {
            img.src = "";
            p.innerText = "ç©ºç™½å­˜æª”";
        }

        slot.appendChild(img);
        slot.appendChild(p);

        slot.onclick = () => {
            if (type === "save") saveToSlot(i);
            else loadFromSlot(i);
        };

        container.appendChild(slot);
    }
}

/* ===== æ“·å–ç•«é¢ ===== */
function captureThumbnail() {
    const canvas = document.createElement("canvas");
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    canvas.getContext("2d").drawImage(video, 0, 0);
    return canvas.toDataURL("image/png");
}

/* ===== å­˜æª” ===== */
function saveToSlot(i) {
    video.pause();

    const saveData = {
        scene: currentScene,
        title: story[currentScene].title,
        time: video.currentTime,      // â­ é—œéµï¼šå­˜å½±ç‰‡ç§’æ•¸
        thumbnail: captureThumbnail()
    };

    localStorage.setItem("save_" + i, JSON.stringify(saveData));
    closeMenus();
}


/* ===== è®€æª” ===== */
function loadFromSlot(i) {
    const data = localStorage.getItem("save_" + i);
    if (!data) return;

    const save = JSON.parse(data);
    closeMenus();

    loadScene(save.scene);

    video.onloadedmetadata = () => {
        video.currentTime = save.time; // â­ è·³å›å­˜æª”æ™‚é–“
        video.play();
    };
}


/* ===== å•Ÿå‹• ===== */
function loadScene(key) {
    currentScene = key;
    const scene = story[key];
    video.src = scene.video;
    options.style.display = "none";
    document.getElementById("restart").style.display = "none";

    video.onended = () => {
        options.innerHTML = "";

        // ğŸŸ¥ å¦‚æœæ˜¯çµå±€
        if (scene.isEnd) {
            document.getElementById("restart").style.display = "block";
            return;
        }

        // ğŸŸ¦ ä¸€èˆ¬é¸é …
        scene.choices.forEach(c => {
            const btn = document.createElement("button");
            btn.textContent = c.text;
            btn.onclick = () => loadScene(c.next);
            options.appendChild(btn);
        });

        if (scene.choices.length) {
            options.style.display = "flex";
        }
    };
}

</script>
    const video = document.getElementById("main-video");
const options = document.getElementById("options");
let currentScene = "start";
let wasPlaying = false; // â­ æ–°å¢ï¼šè¨˜ä½å½±ç‰‡æ˜¯å¦åœ¨æ’­æ”¾



</body>
</html>
